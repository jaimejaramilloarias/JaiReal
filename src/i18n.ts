export type Lang = 'es' | 'en';

const translations: Record<Lang, Record<string, string>> = {
  es: {
    online: 'En línea',
    offline: 'Sin conexión',
    toggleLang: 'EN',
    toggleLangTitle: 'Cambiar a inglés',
    closeMessage: 'Cerrar mensaje',
    saveJson: 'Guardar JSON',
    exportPdf: 'Exportar PDF',
    saveLibrary: 'Guardar en biblioteca',
    openLibrary: 'Abrir de biblioteca',
    library: 'Biblioteca',
    templateLabel: 'Plantilla:',
    newFromTemplate: 'Nueva desde plantilla',
    showSecondary: 'Mostrar renglón secundario ({shortcut})',
    hideSecondary: 'Ocultar renglón secundario ({shortcut})',
    transposeUp: 'Transponer +1 ({s1}) / +12 ({s12})',
    transposeDown: 'Transponer -1 ({s1}) / -12 ({s12})',
    transposeLabel: 'Transposición:',
    resetTranspose: 'Reset Transposición',
    tempoLabel: 'Tempo ({shortcut}, {wheel}):',
    tempoTitle: '{shortcut}, rueda del ratón',
    wheel: 'rueda',
    promptTitle: 'Título',
    promptTags: 'Etiquetas (separadas por coma)',
    masterVolumeLabel: 'Volumen ({shortcut}):',
    chordVolumeLabel: 'Volumen acordes ({shortcut}):',
    chordWaveLabel: 'Timbre acordes:',
    wave_sine: 'Seno',
    wave_square: 'Cuadrada',
    wave_triangle: 'Triangular',
    wave_sawtooth: 'Sierra',
    metronomeOn: 'Activar metrónomo',
    metronomeOff: 'Desactivar metrónomo',
    metronomeVolLabel: 'Volumen metrónomo ({shortcut}):',
    play: 'Reproducir ({shortcut})',
    stop: 'Detener ({shortcut})',
    spaceKey: 'Espacio',
    loopSection: 'Repetir sección',
    instrumentLabel: 'Vista:',
    accidentalLabel: 'Preferir:',
    lightTheme: 'Tema claro',
    darkTheme: 'Tema oscuro',
    fontSizeLabel: 'Tamaño fuente:',
    voltaLabel: 'Volta:',
    voltaFrom: 'desde',
    voltaTo: 'hasta',
    apply: 'Aplicar',
    clearVoltas: 'Borrar voltas',
    markerLabel: 'Marcador:',
    noMarker: '(sin marcador)',
    title: 'Título',
    tag: 'Etiqueta',
    favoritesOnly: 'Solo favoritos',
    statusFilter: 'Estado:',
    status_active: 'Activos',
    status_archived: 'Archivados',
    status_trashed: 'Papelera',
    favorite: 'Favorito',
    unfavorite: 'Quitar favorito',
    archive: 'Archivar',
    trash: 'Papelera',
    restore: 'Restaurar',
    close: 'Cerrar',
  },
  en: {
    online: 'Online',
    offline: 'Offline',
    toggleLang: 'ES',
    toggleLangTitle: 'Switch to Spanish',
    closeMessage: 'Close message',
    saveJson: 'Save JSON',
    exportPdf: 'Export PDF',
    saveLibrary: 'Save to library',
    openLibrary: 'Open from library',
    library: 'Library',
    templateLabel: 'Template:',
    newFromTemplate: 'New from template',
    showSecondary: 'Show secondary line ({shortcut})',
    hideSecondary: 'Hide secondary line ({shortcut})',
    transposeUp: 'Transpose +1 ({s1}) / +12 ({s12})',
    transposeDown: 'Transpose -1 ({s1}) / -12 ({s12})',
    transposeLabel: 'Transposition:',
    resetTranspose: 'Reset Transposition',
    tempoLabel: 'Tempo ({shortcut}, {wheel}):',
    tempoTitle: '{shortcut}, mouse wheel',
    wheel: 'wheel',
    promptTitle: 'Title',
    promptTags: 'Tags (comma-separated)',
    masterVolumeLabel: 'Master volume ({shortcut}):',
    chordVolumeLabel: 'Chord volume ({shortcut}):',
    chordWaveLabel: 'Chord timbre:',
    wave_sine: 'Sine',
    wave_square: 'Square',
    wave_triangle: 'Triangle',
    wave_sawtooth: 'Sawtooth',
    metronomeOn: 'Enable metronome',
    metronomeOff: 'Disable metronome',
    metronomeVolLabel: 'Metronome volume ({shortcut}):',
    play: 'Play ({shortcut})',
    stop: 'Stop ({shortcut})',
    spaceKey: 'Space',
    loopSection: 'Loop section',
    instrumentLabel: 'View:',
    accidentalLabel: 'Prefer:',
    lightTheme: 'Light theme',
    darkTheme: 'Dark theme',
    fontSizeLabel: 'Font size:',
    voltaLabel: 'Volta:',
    voltaFrom: 'from',
    voltaTo: 'to',
    apply: 'Apply',
    clearVoltas: 'Clear voltas',
    markerLabel: 'Marker:',
    noMarker: '(no marker)',
    title: 'Title',
    tag: 'Tag',
    favoritesOnly: 'Favorites only',
    statusFilter: 'Status:',
    status_active: 'Active',
    status_archived: 'Archived',
    status_trashed: 'Trash',
    favorite: 'Favorite',
    unfavorite: 'Unfavorite',
    archive: 'Archive',
    trash: 'Move to trash',
    restore: 'Restore',
    close: 'Close',
  },
};

let currentLang: Lang = 'es';

export function t(key: string, vars?: Record<string, string>): string {
  let str = translations[currentLang][key] ?? key;
  if (vars) {
    for (const [k, v] of Object.entries(vars)) {
      str = str.replace(`{${k}}`, v);
    }
  }
  return str;
}

export function setLang(lang: Lang): void {
  currentLang = lang;
  document.documentElement.lang = lang;
  document.dispatchEvent(new CustomEvent('langchange'));
}

export function getLang(): Lang {
  return currentLang;
}
